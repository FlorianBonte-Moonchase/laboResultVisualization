<!--/*-->
<html>
<head>
    <link rel="stylesheet" type="text/css" href="narrative.css"/>
</head>
<body>
<!--*/-->

<div>
    <div class="hapiHeaderText">
        <!--/*
        Show the DiagnosticReport's name.text value, or if that isn't populated, show the
        display value on the first coding, and if that's missing too show a default "Untitled"
        value
        */-->
        <th:block th:if="${not resource.code.textElement.empty} or ${resource.code.coding.empty}"
                  th:text="${resource.code.textElement.value}"/>
        <th:block
                th:if="${not resource.code.coding.empty} and ${resource.code.textElement.empty} and ${not resource.code.coding[0].displayElement.empty}"
                th:text="${resource.code.coding[0].display}"/>
        <th:block
                th:if="${not resource.code.coding.empty} and ${resource.code.textElement.empty} and ${resource.code.coding[0].displayElement.empty}"
                th:text="'Untitled Diagnostic Report'"/>
        <!--/*--> Complete Blood Count <!--*/-->
    </div>

    <table class="hapiPropertyTable">
        <thead><tr><td colspan="2">Result information</td></tr></thead>
        <tbody>
        <tr th:if="${not resource.statusElement.empty}">
            <td>Status</td>
            <td th:text="${resource.statusElement.value}">Final</td>
        </tr>
        <tr th:if="${not resource.issuedElement.empty}">
            <td>Issued</td>
            <td th:narrative="${resource.issuedElement}">--</td>
        </tr>
        <tr th:if="${not resource.conclusionElement.empty}">
            <td>Conclusion</td>
            <td th:narrative="${resource.conclusionElement}">No conclusion was integrated in this report</td>
        </tr>
        </tbody>

        <th:block th:if="${not resource.subject.resource.empty}">
            <thead><tr><td colspan="2">Patient details</td></tr></thead>
            <tbody>
            <tr th:if="${not resource.subject.resource.identifier.empty}">
                <td>Identifier</td>
                <td th:narrative="${resource.subject.resource.identifier[0]}"></td>
            </tr>
            <tr th:if="${not resource.subject.resource.name.empty}">
                <td>Patient name</td>
                <td th:text="${resource.subject.resource.name[0].nameAsSingleString}">--</td>
            </tr>
            <tr th:if="${not resource.subject.resource.birthDateElement.empty}">
                <td>Date of birth</td>
                <td><span
                        th:text="${#dates.format(resource.subject.resource.birthDateElement.value,'dd MMMM yyyy')}"></span>
                </td>
            </tr>
            <tr th:if="${not resource.subject.resource.address.empty}">
                <td>Address</td>
                <td th:narrative="${resource.subject.resource.address[0]}"></td>
            </tr>
            </tbody>
        </th:block>

    </table>

    <table class="hapiTableOfValues" th:if="${not #lists.isEmpty(resource.result)}">
        <thead>
        <tr>
            <td>Name</td>
            <td>Value</td>
            <td>Interpretation</td>
            <td>Reference Range</td>
            <td>Status</td>
        </tr>
        </thead>
        <tbody>
        <th:block th:each="result,rowStat : ${resource.result}">
            <tr th:class="${not result.resource.hasMember.empty }? 'title' : (${rowStat.odd}? 'hapiTableOfValuesRowOdd' : 'hapiTableOfValuesRowEven')" class="hapiTableOfValuesRowOdd">
                <td>
                    <th:block th:if="${not result.resource.code.textElement.empty}"
                              th:text="${result.resource.code.textElement.value}"/>
                    <th:block
                            th:if="${result.resource.code.textElement.empty} and ${not #lists.isEmpty(result.resource.code.coding)} and ${not result.resource.code.coding[0].empty} and ${not result.resource.code.coding[0].displayElement.empty}"
                            th:text="${result.resource.code.coding[0].display}"/>
                    <th:block
                            th:if="${result.resource.code.textElement.empty} and ${not #lists.isEmpty(result.resource.code.coding)} and ${not result.resource.code.coding[0].empty} and ${result.resource.code.coding[0].displayElement.empty}"
                            th:text="'?'"/>
                    <!--/*--> Hb <!--*/-->
                </td>
                <td th:narrative="${result.resource.value}">--</td>
                <td>
                    <th:block
                            th:if="${not result.resource.interpretation.empty} and ${not result.resource.interpretation[0].textElement.empty}"
                            th:text="${result.resource.interpretation[0].text}"/>
                    <th:block
                            th:if="${not result.resource.interpretation.empty} and ${result.resource.interpretation[0].textElement.empty} and ${not result.resource.interpretation[0].coding.empty} and ${not result.resource.interpretation[0].coding[0].displayElement.empty}"
                            th:text="${result.resource.interpretation.coding[0].display}"/>
                    <!--/*--> N <!--*/-->
                </td>
                <td>
                    <th:block
                            th:if="${not result.resource.referenceRange.empty} and ${not result.resource.referenceRange[0].empty}">
                        <th:block th:narrative="${result.resource.referenceRange[0].low}">--</th:block>
                        -
                        <th:block th:narrative="${result.resource.referenceRange[0].high}">--</th:block>
                    </th:block>
                </td>
                <td th:text="${result.resource.statusElement.value}">final</td>
            </tr>
            <th:block th:each="result,rowStat : ${result.resource.hasMember}">
                <tr th:class="${rowStat.odd}? 'hapiTableOfValuesRowOddLight' : 'hapiTableOfValuesRowEvenLight'" class="hapiTableOfValuesRowOddLight">
                    <td>
                        <th:block th:if="${not result.resource.code.textElement.empty}"
                                  th:text="${result.resource.code.textElement.value}"/>
                        <th:block
                                th:if="${result.resource.code.textElement.empty} and ${not #lists.isEmpty(result.resource.code.coding)} and ${not result.resource.code.coding[0].empty} and ${not result.resource.code.coding[0].displayElement.empty}"
                                th:text="${result.resource.code.coding[0].display}"/>
                        <th:block
                                th:if="${result.resource.code.textElement.empty} and ${not #lists.isEmpty(result.resource.code.coding)} and ${not result.resource.code.coding[0].empty} and ${result.resource.code.coding[0].displayElement.empty}"
                                th:text="'?'"/>
                        <!--/*--> Hb <!--*/-->
                    </td>
                    <td th:narrative="${result.resource.value}">--</td>
                    <td>
                        <th:block
                                th:if="${not result.resource.interpretation.empty} and ${not result.resource.interpretation[0].textElement.empty}"
                                th:text="${result.resource.interpretation[0].text}"/>
                        <th:block
                                th:if="${not result.resource.interpretation.empty} and ${result.resource.interpretation[0].textElement.empty} and ${not result.resource.interpretation[0].coding.empty} and ${not result.resource.interpretation[0].coding[0].displayElement.empty}"
                                th:text="${result.resource.interpretation.coding[0].display}"/>
                        <!--/*--> N <!--*/-->
                    </td>
                    <td>
                        <th:block
                                th:if="${not result.resource.referenceRange.empty} and ${not result.resource.referenceRange[0].empty}">
                            <th:block th:narrative="${result.resource.referenceRange[0].low}">--</th:block>
                            -
                            <th:block th:narrative="${result.resource.referenceRange[0].high}">--</th:block>
                        </th:block>
                    </td>
                    <td th:text="${result.resource.statusElement.value}">final</td>
                </tr>
            </th:block>
            <tr th:if="${not result.resource.note.empty}"
                th:class="${rowStat.odd}? 'hapiTableOfValuesRowOdd' : 'hapiTableOfValuesRowEven'"
                class="hapiTableOfValuesRowOdd">
                <td th:text="${result.resource.note[0].text}" colspan="5">This is a comment</td>
            </tr>

        </th:block>
        </tbody>
    </table>

</div>


<!--/*-->
</body>
</html>
<!--*/-->
