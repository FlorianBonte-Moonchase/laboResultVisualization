<!--/*-->
<html>
<head>
    <link rel="stylesheet" type="text/css" href="narrative.css"/>
</head>
<body>
<!--*/-->
<th:block th:fragment="details (result)">
    <thead>
    <tr>
        <td colspan="2">Details</td>
    </tr>
    </thead>
    <tbody>
    <tr th:if="${result.resource.hasLanguage}">
        <td>Language</td>
        <td th:text="${result.resource.language}"/>
    </tr>
    <tr th:if="${result.resource.hasCategory}">
        <td>Category</td>
        <td th:text="${result.resource.category}"/>
    </tr>
    <tr th:if="${result.resource.hasEffectiveDateTimeType}">
        <td>Effective date (datetime)</td>
        <td th:text="${#dates.format(result.resource.effectiveDateTimeType.value,'dd MMMM yyyy hh:mm:ss')}"/>
    </tr>
    <tr th:if="${result.resource.hasEffectivePeriod}">
        <td>Effective date (period)</td>
        <td><span th:if="${result.resource.effectivePeriod.hasStartElement}"
                  th:text="${#dates.format(result.resource.effectivePeriod.startElement.value,'dd MMMM yyyy')}">...</span>
            -
            <span
                    th:if="${result.resource.effectivePeriod.hasEndElement}"
                    th:text="${#dates.format(result.resource.effectivePeriod.endElement.value,'dd MMMM yyyy')}">...</span>
        </td>
    </tr>
    <!-- will effective timing ever occur in context of lab results? -->
    <!--tr th:if="${result.resource.hasEffectiveTiming}">
        <td>Effective date</td>
        <td>(effective timing)</td>
    </tr-->
    <tr th:if="${result.resource.hasEffectiveInstantType}">
        <td>Effective date (instant)</td>
        <td th:text="${#dates.format(result.resource.effectiveInstantType.value,'dd MMMM yyyy hh:mm:ss')}"/>
    </tr>
    <tr th:if="${result.resource.hasIssuedElement}">
        <td>Issued date</td>
        <td th:text="${#dates.format(result.resource.issuedElement.value,'dd MMMM yyyy hh:mm:ss')}"/>
    </tr>
    <tr th:if="${result.resource.hasDataAbsentReason}">
        <td>Data absent reason</td>
        <td th:include="@{inlinecode} :: inlinecode (${result.resource.dataAbsentReason})"></td>
    </tr>
    <tr th:if="${result.resource.hasBodySite}">
        <td>Body site</td>
        <td th:include="@{inlinecode} :: inlinecode (${result.resource.bodySite})"></td>
    </tr>
    <!-- derivedFrom shows which other observation(s) this observation was derived from,
         is this usefull clinical information to show in the visualizer? How do we show the other observations this has been derived from?
         Include all information of that observation -again- in a collapsible sub-table? The screen will get very busy imo. -->
    <!--th:block th:if="${result.resource.hasDerivedFrom}" th:each="derivedFrom : ${result.resource.hasDerivedFrom}">
        <tr>
            <td>Derived from</td>
            <td>(derived from)</td>
        </tr>
    </th:block-->
    <tr th:if="${result.resource.hasComponent}" th:each="component : ${result.resource.component}">
        <td>Component</td>
        <td>
            <th:block
                    th:if="${not component.hasValueQuanity} and ${not component.hasValueCodeableConcept} and ${not component.hasValueStringType}"
                    th:text="'(component without quantity, code or string?)'"/>

            <th:block th:if="${component.hasValueQuantity} and ${not component.valueQuantity.comparatorElement.empty}"
                      th:text="${component.valueQuantity.comparatorElement.value}"/>
            <th:block th:if="${component.hasValueQuantity} and ${not component.valueQuantity.valueElement.empty}"
                      th:text="${component.valueQuantity.valueElement.valueAsString}"/>
            <th:block th:if="${component.hasValueQuantity} and ${not component.valueQuantity.unitElement.empty}"
                      th:text="${component.valueQuantity.unitElement.value}"/>
            <th:block th:if="${component.hasValueStringType}" th:text="${component.valueStringType} + ' '"/>
            <th:block th:if="${component.hasValueCodeableConcept} and ${${component.valueCodeableConcept.hasCoding}}">
                <th:block th:if="${component.valueCodeableConcept.codingFirstRep.hasDisplay}"
                          th:text="${component.valueCodeableConcept.codingFirstRep.display} + ' '"/>
                <th:block th:if="${component.valueCodeableConcept.codingFirstRep.hasSystem}"
                          th:text="'(' + ${component.valueCodeableConcept.codingFirstRep.system} + ') '"/>
                <th:block th:if="${component.valueCodeableConcept.codingFirstRep.hasCode}"
                          th:text="'(' + ${component.valueCodeableConcept.codingFirstRep.code} + ') '"/>
            </th:block>
        </td>
    </tr>
    </tbody>
</th:block>
<!--/*-->
</body>
</html>
<!--*/-->
