<!--/*-->
<html>
<head>
    <link rel="stylesheet" type="text/css" href="narrative.css"/>
</head>
<body>
<!--*/-->
<th:block th:fragment="observations (items,level)">
    <th:block th:each="result,rowStat : ${items}">
        <tr th:class="'level_'+${level} + ' ' + (${not result.resource.hasMember.empty }? 'title' : (${rowStat.odd}? 'hapiTableOfValuesRowOdd' : 'hapiTableOfValuesRowEven'))" class="hapiTableOfValuesRowOdd">
            <td class="label">
                <th:block th:if="${not result.resource.code.textElement.empty}"
                          th:text="${result.resource.code.textElement.value}"/>
                <th:block
                        th:if="${result.resource.code.textElement.empty} and ${not #lists.isEmpty(result.resource.code.coding)} and ${not result.resource.code.coding[0].empty} and ${not result.resource.code.coding[0].displayElement.empty}"
                        th:text="${result.resource.code.coding[0].display}"/>
                <th:block
                        th:if="${result.resource.code.textElement.empty} and ${not #lists.isEmpty(result.resource.code.coding)} and ${not result.resource.code.coding[0].empty} and ${result.resource.code.coding[0].displayElement.empty}"
                        th:text="'?'"/>
                <!--/*--> Hb <!--*/-->
            </td>
            <td th:narrative="${result.resource.value}">--</td>
            <td>
                <th:block
                        th:if="${not result.resource.interpretation.empty} and ${not result.resource.interpretation[0].textElement.empty}"
                        th:text="${result.resource.interpretation[0].text}"/>
                <th:block
                        th:if="${not result.resource.interpretation.empty} and ${result.resource.interpretation[0].textElement.empty} and ${not result.resource.interpretation[0].coding.empty} and ${not result.resource.interpretation[0].coding[0].displayElement.empty}"
                        th:text="${result.resource.interpretation[0].coding[0].display}"/>
                <!--/*--> N <!--*/-->
            </td>
            <td>
                <th:block th:each="ref,rowStat : ${result.resource.referenceRange}">
                    <th:block th:if="${not ref.low.empty} and ${not ref.high.empty}">
                        <th:block th:narrative="${ref.low}">--</th:block>&nbsp;-&nbsp;<th:block th:narrative="${ref.high}">--</th:block>
                    </th:block>
                    <th:block th:if="${ref.low.empty} and ${not ref.high.empty}">
                        &lt;&nbsp;<th:block th:narrative="${ref.high}"></th:block>
                    </th:block>
                    <th:block th:if="${not ref.low.empty} and ${ref.high.empty}">
                        &gt;&nbsp;<th:block th:narrative="${ref.low}"></th:block>
                    </th:block>
                    <th:block th:if="${ref.hasTextElement}">
                        <th:block th:narrative="${ref.textElement}"></th:block>
                    </th:block>
                </th:block>
            </td>
            <td>
                <th:block th:text="${result.resource.statusElement.value}">final</th:block>
            </td>
            <td class="toggable" onclick="this.classList.toggle('displayed');  this.parentElement.nextElementSibling.classList.toggle('hidden');">
                <div>
                    <span class="inline clicktoshow">+</span><span class="inline clicktohide">-</span>
                </div>
            </td>
        </tr>
        <tr th:class="'hidden'">
            <td colspan="6">
               <table>
                    <tbody>
                        <tr th:if="${result.resource.hasCategory}">
                            <td>Category</td>
                            <td th:text="${result.resource.category}"/>
                        </tr>
                        <tr th:if="${result.resource.hasEffectiveDateTimeType}">
                            <td>Effective date</td>
                            <td th:text="${#dates.format(result.resource.effectiveDateTimeType.value,'dd MMMM yyyy hh:mm:ss')}"/>
                        </tr>
                        <tr th:if="${result.resource.hasEffectivePeriod}">
                            <td>Effective date</td>
                            <td>(effective period)</td>
                        </tr>
                        <tr th:if="${result.resource.hasEffectiveTiming}">
                            <td>Effective date</td>
                            <td>(effective timing)</td>
                        </tr>
                        <tr th:if="${result.resource.hasEffectiveInstantType}">
                            <td>Effective date</td>
                            <td>(effective instant)</td>
                        </tr>
                        <tr th:if="${result.resource.hasIssuedElement}">
                            <td>Issued date</td>
                            <td th:text="${#dates.format(result.resource.issuedElement.value,'dd MMMM yyyy hh:mm:ss')}"/>
                        </tr>
                        <tr th:if="${result.resource.hasDataAbsentReason}">
                            <td>Data absent reason</td>
                            <td>(data absent reason)</td>
                        </tr>
                        <tr th:if="${result.resource.hasBodySite}">
                            <td>Body site</td>
                            <td>(body site)</td>
                        </tr>
                        <tr th:if="${result.resource.hasDerivedFrom}">
                            <td>Derived from</td>
                            <td>(derived from)</td>
                        </tr>
                        <tr th:if="${result.resource.hasComponent}">
                            <td>Component</td>
                            <td>(component)</td>
                        </tr>
                    </tbody>
               </table>
            </td>
        </tr>
        <tr th:replace="@{observations} :: observations (items=${result.resource.hasMember},level=${level}+1)"></tr>
        <th:block th:if="${result.resource.hasNote}" th:each="note : ${result.resource.note}">
            <tr th:class="${rowStat.odd}? 'hapiTableOfValuesRowOdd' : 'hapiTableOfValuesRowEven'"
                class="hapiTableOfValuesRowOdd">
                <td th:text="${note.text}" colspan="5">This is a comment</td>
            </tr>
        </th:block>
    </th:block>
</th:block>
<!--/*-->
</body>
</html>
<!--*/-->
